<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
  html, body {
    width: 1920px;
    height: 1080px;
    margin: 0;
    padding: 0;
    background: transparent;
    overflow: hidden;
  }

  #ticker-bar {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 60px; /* reverted to original height */
    display: flex;
    align-items: stretch;
    font-family: sans-serif;
    font-size: 32px;      /* slightly larger than original 28px, but still fits */
    color: white;
  }

  #logo {
    background: #c00;
    color: white;
    padding: 0 20px;
    font-weight: bold;
    font-family: sans-serif;
    letter-spacing: 1px;
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100%;
    box-shadow: inset 0 -2px 0 rgba(255, 255, 255, 0.2);
    box-sizing: border-box;
  }

  #ticker-text {
    background: linear-gradient(to right, #111 0%, #222 100%);
    flex: 1;
    padding-left: 20px;
    white-space: nowrap;
    overflow: hidden;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.6);
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
    display: flex;
    align-items: center;
    height: 100%;
    box-sizing: border-box;
  }

  #center-display {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    max-width: 80%;
    max-height: 80%;
    display: none;
    z-index: 10;
  }

  #center-display img {
    width: 100%;
    height: auto;
  }
  </style>
</head>
<body>
  <div id="ticker-bar">
    <div id="logo">DNN</div>
    <div id="ticker-text">Welcome to the Darmunist News Network.</div>
  </div>
  <div id="center-display"><img src="" alt="overlay" /></div>

<script>
  window.onload = () => {
    const tickerText = document.getElementById("ticker-text");
    console.log("üß™ tickerText element:", tickerText);

    const ws = new WebSocket("ws://localhost:6789");

    ws.onopen = () => {
      console.log("‚úÖ WebSocket connection established.");
    };

    ws.onclose = (event) => {
      console.log("‚ùå WebSocket connection closed:", event);
    };

    ws.onerror = (err) => {
      console.error("‚ùå WebSocket error:", err);
    };

    ws.onmessage = (event) => {
      console.log("üì® WebSocket message received:", event.data);
      try {
        const msg = JSON.parse(event.data);

        if (msg.type === "ticker" && typeof msg.text === "string") {
          tickerText.innerHTML = "";                // Clear old text
          tickerText.innerHTML = msg.text;          // Update with new message
          console.log("üñäÔ∏è Ticker updated:", msg.text);
        } else if (msg.type === "image" && typeof msg.url === "string") {
          const display = document.getElementById("center-display");
          const img = display.querySelector("img");
          img.src = msg.url;
          display.style.display = "block";
          setTimeout(() => {
            display.style.display = "none";
          }, msg.duration || 5000);
        } else {
          console.warn("‚ö†Ô∏è Unknown message format:", msg);
        }
      } catch (err) {
        console.error("‚ùå Failed to parse or handle message:", err);
      }
    };
  };
</script>

</body>
</html>